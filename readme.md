# Сервис подбора рекламных площадок

## Описание проекта

Веб-сервис для хранения и поиска рекламных площадок по локациям. Сервис позволяет загружать данные о рекламных площадках из текстового файла и выполнять быстрый поиск площадок, действующих в указанной локации (включая родительские локации).

## Функциональность

- **Загрузка данных**: POST-метод для загрузки рекламных площадок из файла
- **Поиск площадок**: GET-метод для поиска площадок по указанной локации
- **In-memory хранение**: Данные хранятся в оперативной памяти для максимальной скорости поиска
- **Поддержка вложенных локаций**: Автоматический поиск площадок для родительских локаций

## Технологии

- ASP.NET Core 8.0
- xUnit для тестирования
- FluentAssertions для проверок
- Moq для мокирования
- Swagger для документации API

## Запуск приложения

### Предварительные требования
- .NET 8.0 SDK или новее

### Запуск сервера
1. Клонируйте репозиторий
2. Перейдите в папку проекта: `cd EffectiveMobile`
3. Восстановите зависимости: `dotnet restore`
4. Запустите приложение: `dotnet run`
5. Откройте браузер и перейдите по адресу: `http://localhost:5000/swagger`

### Запуск тестов
1. Перейдите в папку с тестами: `cd TestProject`
2. Запустите тесты: `dotnet test`

Или из корневой папки решения:
```bash
dotnet test
```

## Использование API
### 1. Загрузка рекламных площадок из файла
- **Метод:** POST
- **URL:** /api/Advertisement/load
- **Параметры:** form-data с файлом (ключ: file)

**Пример:**
```bash
curl -X POST -F "file=@test-data.txt" http://localhost:5000/api/Advertisement/load
```
### 2. Поиск рекламных площадок по локации
- **Метод:** GET
- **URL:** /api/Advertisement/search?location=/ru/msk

**Пример:**
```bash
curl "http://localhost:5000/api/Advertisement/search?location=/ru/msk"
```
## 📁 Пример файла с данными
```text
Яндекс.Директ:/ru
Ревдинский рабочий:/ru/svr d/r ev da, /ru/svr d/per v i k
Газета уральских москвичей:/ru/msk, /ru/per mobl, /ru/che l obl
Крутая реклама:/ru/svr d
```
## 📂 Структура проекта
```text
EffectiveMobile/
├── Controllers/           # API контроллеры
├── Models/               # Модели данных
├── Services/             # Бизнес-логика
├── Properties/           # Настройки запуска
├── TestProject/          # Тесты
│   ├── Controllers/      # Тесты контроллеров
│   ├── Services/         # Тесты сервисов
│   └── Integration/      # Интеграционные тесты
├── appsettings.json      # Конфигурация приложения
├── Program.cs            # Точка входа
└── test-data.txt         # Пример данных
```
## Реализованная функциональность
**REST API**
- Метод загрузки данных из файла
- Метод поиска по локации

**Обработка данных**
- Парсинг текстового файла с рекламными площадками
- Нормализация локаций (удаление лишних пробелов)
- Хранение данных в памяти для быстрого доступа

**Поиск с учетом вложенности**
- Автоматический поиск площадок для родительских локаций
- Например, для локации /ru/svr d/r ev da будут найдены площадки:
	- Для /ru/svr d/r ev da (если есть)
	- Для /ru/svr d (родительская)
	- Для /ru (корневая)

**Обработка ошибок**
- Проверка входных параметров
- Обработка исключений
- Корректные HTTP-статусы ответов

**Тестирование**
- Unit-тесты сервисов
- Unit-тесты контроллеров
- Интеграционные тесты API
